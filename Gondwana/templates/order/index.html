{% extends 'base.html' %}

{% block title %}
    Order
{% endblock %}

{% block header %}
    Order
{% endblock %}

{% block button %}
{% endblock %}

{% block content %}
    <form action="{{ url_for('order.order_index') }}" method='POST'>
    <div class="input-group mb-3">
        <div class="input-group-prepend">
<!-- channel filter -->
            <input id="channelFilter" name="channelFilter" type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" value="All Channel">
            <div class="dropdown-menu" aria-labelledby="channelFilter">
                <button class="channelFilterOptions dropdown-item" type="button" value="-1">All Channel</button>
                {% if channels %}
                    <div class="dropdown-divider"></div>
                    {% for channel in channels %}
                    <button class="channelFilterOptions dropdown-item " type="button" value="{{ channel.id }}">{{ channel.name }}</button>
                    {% endfor %}
                {% endif %}
            </div>
<!-- channel filter end -->
        </div>
        <input type="text" name="keyword" class="form-control">
<!-- status filter -->
        <div class="input-group-append">
            <input id="statusFilter" name="statusFilter" type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" value="All Status">
            <div class="dropdown-menu" aria-labelledby="statusFilter">
                <button class="statusFilterOptions dropdown-item" type="button"value="-1">All Status</a>
                <div class="dropdown-divider"></div>
                <button class="statusFilterOptions dropdown-item" type="button"value="P">{{ 'P' | order_status_2_name }}</button>
                <button class="statusFilterOptions dropdown-item" type="button"value="C">{{ 'C' | order_status_2_name }}</button>
                <button class="statusFilterOptions dropdown-item" type="button"value="O">{{ 'O' | order_status_2_name }}</button>
                <button class="statusFilterOptions dropdown-item" type="button"value="F">{{ 'F' | order_status_2_name }}</button>
                <button class="statusFilterOptions dropdown-item" type="button"value="D">{{ 'D' | order_status_2_name }}</button>
                <button class="statusFilterOptions dropdown-item" type="button"value="B">{{ 'B' | order_status_2_name }}</button>
                <button class="statusFilterOptions dropdown-item" type="button"value="I">{{ 'I' | order_status_2_name }}</button>
                <button class="statusFilterOptions dropdown-item" type="button"value="Y">{{ 'Y' | order_status_2_name }}</button>
                <button class="statusFilterOptions dropdown-item" type="button"value="A">{{ 'A' | order_status_2_name }}</button>
                <button class="statusFilterOptions dropdown-item" type="button"value="E">{{ 'E' | order_status_2_name }}</button>
                <div class="dropdown-divider"></div>
                <button class="statusFilterOptions dropdown-item" type="button"value="G">{{ 'G' | order_status_2_name }}</button>
                <button class="statusFilterOptions dropdown-item" type="button"value="H">{{ 'H' | order_status_2_name }}</button>
                <button class="statusFilterOptions dropdown-item" type="button"value="J">{{ 'J' | order_status_2_name }}</button>
            </div>
        </div>
<!-- status filter end -->
<!-- search button -->
        <div class="input-group-append">
            <input type="submit" class="btn btn-danger btn-secondary" value="Search">
        </div>
<!-- search button end-->
    </div>

    {% if orders %}
    <table class="table table-striped table-hover">
        <thead class="thead-dark">
            <tr>
                <th>Channel</th>
                <th>OrderId</th>
                <th>Status</th>
                <th>OPERATIONS</th>
            </tr>
        </thead>
        <tbody>
            {% for order in orders %}
            <tr>
                <td>{{ order.channel.name }}</td>
                <td>{{ order.order_id }}</td>
                <td>
    <div class="btn-group">
        <button id="statusUpdater" type="button" class="btn btn-sm btn-info btn-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"></button>
        <div class="dropdown-menu" aria-labelledby="statusUpdater">
            <a class="dropdown-item {% if order.status=='P' %}disabled{% endif %}" href="{{ url_for('order.order_update_status', channel_id=order.channel_id, order_id=order.id, status='P') }}">{{ 'P' | order_status_2_name }}</a>
            <a class="dropdown-item {% if order.status=='C' %}disabled{% endif %}" href="{{ url_for('order.order_update_status', channel_id=order.channel_id, order_id=order.id, status='C') }}">{{ 'C' | order_status_2_name }}</a>
            <a class="dropdown-item {% if order.status=='O' %}disabled{% endif %}" href="{{ url_for('order.order_update_status', channel_id=order.channel_id, order_id=order.id, status='O') }}">{{ 'O' | order_status_2_name }}</a>
            <a class="dropdown-item {% if order.status=='F' %}disabled{% endif %}" href="{{ url_for('order.order_update_status', channel_id=order.channel_id, order_id=order.id, status='F') }}">{{ 'F' | order_status_2_name }}</a>
            <a class="dropdown-item {% if order.status=='D' %}disabled{% endif %}" href="{{ url_for('order.order_update_status', channel_id=order.channel_id, order_id=order.id, status='D') }}">{{ 'D' | order_status_2_name }}</a>
            <a class="dropdown-item {% if order.status=='B' %}disabled{% endif %}" href="{{ url_for('order.order_update_status', channel_id=order.channel_id, order_id=order.id, status='B') }}">{{ 'B' | order_status_2_name }}</a>
            <a class="dropdown-item {% if order.status=='I' %}disabled{% endif %}" href="{{ url_for('order.order_update_status', channel_id=order.channel_id, order_id=order.id, status='I') }}">{{ 'I' | order_status_2_name }}</a>
            <a class="dropdown-item {% if order.status=='Y' %}disabled{% endif %}" href="{{ url_for('order.order_update_status', channel_id=order.channel_id, order_id=order.id, status='Y') }}">{{ 'Y' | order_status_2_name }}</a>
            <a class="dropdown-item {% if order.status=='A' %}disabled{% endif %}" href="{{ url_for('order.order_update_status', channel_id=order.channel_id, order_id=order.id, status='A') }}">{{ 'A' | order_status_2_name }}</a>
            <a class="dropdown-item {% if order.status=='E' %}disabled{% endif %}" href="{{ url_for('order.order_update_status', channel_id=order.channel_id, order_id=order.id, status='E') }}">{{ 'E' | order_status_2_name }}</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item {% if order.status=='G' %}disabled{% endif %}" href="{{ url_for('order.order_update_status', channel_id=order.channel_id, order_id=order.id, status='G') }}">{{ 'G' | order_status_2_name }}</a>
            <a class="dropdown-item {% if order.status=='H' %}disabled{% endif %}" href="{{ url_for('order.order_update_status', channel_id=order.channel_id, order_id=order.id, status='H') }}">{{ 'H' | order_status_2_name }}</a>
            <a class="dropdown-item {% if order.status=='J' %}disabled{% endif %}" href="{{ url_for('order.order_update_status', channel_id=order.channel_id, order_id=order.id, status='J') }}">{{ 'J' | order_status_2_name }}</a>
        </div>
    </div>
                    {{ order.status|order_status_2_name }}
                </td>
                <td>
                    <a role="button" href="{{ url_for('order.order_detail', order_id=order.id) }}" class="btn btn-primary btn-sm">Detail</a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    </form>
    {% else %}
    <h3>No orders here.</h3>
    {% endif %}

<script type="text/javascript">
// channel filter
var channelFilter = -1;
$('.channelFilterOptions').on("click",function(){
    // https://stackoverflow.com/questions/3871228/get-text-from-anchor-tag
    $('#channelFilter').val($(this).text());
    channelFilter = $(this).val();
})

// status filter
var statusFilter = -1;
$('.statusFilterOptions').on("click",function(){
    $('#statusFilter').val($(this).text());
    statusFilter = $(this).val();
})
</script>
{% endblock %}
